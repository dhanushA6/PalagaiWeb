"use strict";(self.webpackChunkkta_utchol=self.webpackChunkkta_utchol||[]).push([[80],{5338:(e,t,r)=>{var a=r(86672);t.createRoot=a.createRoot,t.hydrateRoot=a.hydrateRoot},20080:(e,t,r)=>{var a=r(44914),n=r.n(a),s=r(5338),o=r(99180),l=r(45458),c=r(10467),u=r(80296),i=r(54756),d=r.n(i),v=r(8700),p=r(30660),m=r(83550),h=r(31129),g=r(612),f=r(9419),k=(r(28870),r(30955)),x=r(74848),S=(0,a.createContext)(),A=function(){var e=(0,o.useNavigate)(),t=(0,a.useContext)(S),r=t.userID,n=t.levelValue,s=t.mode,i=(0,a.useState)(0),v=(0,u.A)(i,2),p=v[0],g=v[1],k=(0,a.useState)(null),A=(0,u.A)(k,2),L=A[0],y=A[1],w=(0,a.useState)(!0),j=(0,u.A)(w,2),C=j[0],b=j[1],R=(0,a.useState)(null),D=(0,u.A)(R,2),M=D[0],I=D[1],E=(0,a.useState)(0),N=(0,u.A)(E,2),T=N[0],O=N[1],P=(0,a.useState)({}),V=(0,u.A)(P,2),B=V[0],J=V[1],U=(0,a.useState)({}),_=(0,u.A)(U,2),F=_[0],q=_[1],G=(0,a.useState)({}),H=(0,u.A)(G,2),z=H[0],K=H[1],Q=(0,a.useState)([]),W=(0,u.A)(Q,2),X=W[0],Y=W[1];(0,a.useRef)(!1),(0,a.useEffect)((function(){r&&n&&s&&Z(n,r,s)}),[r,n,s]);var Z=function(){var e=(0,c.A)(d().mark((function e(t,r,a){var n,s,o,l;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!0),e.prev=1,n=new URLSearchParams({level:t,userid:r,mode:a}).toString(),e.next=5,fetch("https://thambaa.karky.in:6128/thamba/game/palagai/play?".concat(n));case 5:return s=e.sent,e.next=8,s.json();case 8:if((o=e.sent).letters)try{l="string"==typeof o.letters?JSON.parse(o.letters):o.letters,K(l),console.log("Letters data loaded:",l)}catch(e){console.error("Error parsing letters data:",e),K({})}else K({});y(o),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),I(e.t0.message);case 16:return e.prev=16,b(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[1,13,16,19]])})));return function(t,r,a){return e.apply(this,arguments)}}(),$=function(){var t=(0,c.A)(d().mark((function t(){var a,o,c,u,i,v,m,h,f,k,x,S=arguments;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=S.length>0&&void 0!==S[0]?S[0]:100,o=S.length>1&&void 0!==S[1]?S[1]:0,O((function(e){return e+a})),c=L.contents[p],u={task:c.task,type:c.type,taskid:c.taskid,accuracy:a.toString(),wpm:"0",cpm:"0",timeTaken:o.toString(),found:"true"},Y((function(e){return[].concat((0,l.A)(e),[u])})),p===L.contents.length-1){t.next=11;break}g((function(e){return e+1})),t.next=50;break;case 11:return t.prev=11,(i=new URLSearchParams).append("mode",s),i.append("userid",r),i.append("level",n.toString()),i.append("contents",JSON.stringify([].concat((0,l.A)(X),[u]))),i.append("letters",JSON.stringify(z)),console.log("POST Request Body:"),console.log("Form Data:",i.toString()),console.log("Mode:",s),console.log("UserID:",r),console.log("Level:",n.toString()),console.log("Contents:",JSON.stringify([].concat((0,l.A)(X),[u]),null,2)),console.log("Letters:",JSON.stringify(z,null,2)),t.next=27,fetch("https://thambaa.karky.in:6128/thamba/game/palagai/update",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i.toString()});case 27:if(t.sent.ok){t.next=30;break}throw new Error("Failed to update game data");case 30:if("freeplay"!==s){t.next=38;break}return t.next=33,Z(n,r,s);case 33:O(0),Y([]),g(0),t.next=44;break;case 38:e("/game/complete",{state:{totalScore:T+a,currentLevelMistakes:B,currentLevelCorrect:F,letterData:z,totalTasks:(null==L||null===(v=L.contents)||void 0===v?void 0:v.length)||0,taskMetrics:[].concat((0,l.A)(X),[u])}}),m=[].concat((0,l.A)(X),[u]),h=m.length>0?Math.round(m.reduce((function(e,t){return e+Number(t.accuracy)}),0)/m.length):0,f=m.reduce((function(e,t){return e+Number(t.timeTaken)}),0),k={type:"levelComplete",data:{level:n,timeTaken:f,points:h}},window.parent.postMessage(k,"*");case 44:t.next=50;break;case 46:t.prev=46,t.t0=t.catch(11),console.error("Error updating game data:",t.t0),e("/game/complete",{state:{totalScore:T+a,currentLevelMistakes:B,currentLevelCorrect:F,letterData:z,totalTasks:(null==L||null===(x=L.contents)||void 0===x?void 0:x.length)||0,taskMetrics:[].concat((0,l.A)(X),[u])}});case 50:case"end":return t.stop()}}),t,null,[[11,46]])})));return function(){return t.apply(this,arguments)}}();if(C)return(0,x.jsx)("div",{children:"Loading..."});if(M)return(0,x.jsxs)("div",{children:["Error: ",M]});if(!L||!L.contents)return(0,x.jsx)("div",{children:"No game data available"});var ee=L.contents[p];return"Teach"===ee.type&&(0,f.uC)(ee.task)?(0,x.jsx)(h.A,{task:ee,onComplete:$,currentLevelMistakes:B,currentLevelCorrect:F,setCurrentLevelMistakes:J,setCurrentLevelCorrect:q,letterData:z,setLetterData:K,mode:s,userID:r,level:n}):(0,x.jsx)(m.A,{task:ee,onComplete:$,currentLevelMistakes:B,currentLevelCorrect:F,setCurrentLevelMistakes:J,setCurrentLevelCorrect:q,letterData:z,setLetterData:K,mode:s,userID:r,level:n})},L=function(){(0,o.useNavigate)();var e,t,r,a,n,s,l=(0,o.useLocation)(),c=(null===(e=l.state)||void 0===e?void 0:e.totalScore)||0,u=(null===(t=l.state)||void 0===t?void 0:t.currentLevelMistakes)||{},i=(null===(r=l.state)||void 0===r?void 0:r.currentLevelCorrect)||{},d=(null===(a=l.state)||void 0===a?void 0:a.letterData)||{},v=(null===(n=l.state)||void 0===n?void 0:n.totalTasks)||0,p=(null===(s=l.state)||void 0===s?void 0:s.taskMetrics)||[];return(0,x.jsx)("div",{className:"completion-screen",children:(0,x.jsx)(g.A,{score:c,totalTasks:v,currentLevelMistakes:u,currentLevelCorrect:i,letterData:d,taskMetrics:p})})};function y(){var e=(0,a.useState)(1),t=(0,u.A)(e,2),r=t[0],n=t[1],s=(0,a.useState)(9),l=(0,u.A)(s,2),c=l[0],i=l[1],d=(0,a.useState)("activity"),m=(0,u.A)(d,2),h=m[0],g=m[1];return(0,a.useEffect)((function(){(0,k.a)();var e=function(e){if(e.data&&e.data.userID&&e.data.levelValue&&e.data.mode){var t=e.data,r=t.userID,a=t.levelValue,s=t.mode;n(r),i(a),g(s),console.log("Received userID:",r,"levelValue:",a,"mode:",s)}else console.warn("Invalid message received:",e.data)};return window.addEventListener("message",e),function(){window.removeEventListener("message",e)}}),[]),(0,x.jsx)(S.Provider,{value:{userID:r,levelValue:c,mode:h},children:(0,x.jsx)(o.HashRouter,{basename:"MISSING_ENV_VAR".PUBLIC_URL,children:(0,x.jsxs)(o.Routes,{children:[(0,x.jsx)(o.Route,{path:"/",element:(0,x.jsx)(v.A,{})}),(0,x.jsx)(o.Route,{path:"/help",element:(0,x.jsx)(p.A,{})}),(0,x.jsx)(o.Route,{path:"/game",element:(0,x.jsx)(A,{})}),(0,x.jsx)(o.Route,{path:"/game/complete",element:(0,x.jsx)(L,{})})]})})})}var w=document.getElementById("app");if(!w)throw new Error("Failed to find the root element");s.createRoot(w).render((0,x.jsx)(y,{}));const j=y;var C=r(85072),b=r.n(C),R=r(97825),D=r.n(R),M=r(77659),I=r.n(M),E=r(55056),N=r.n(E),T=r(10540),O=r.n(T),P=r(41113),V=r.n(P),B=r(28972),J={};J.styleTagTransform=V(),J.setAttributes=N(),J.insert=I().bind(null,"head"),J.domAPI=D(),J.insertStyleElement=O(),b()(B.A,J),B.A&&B.A.locals&&B.A.locals;var U=document.getElementById("app");(0,s.createRoot)(U).render((0,x.jsx)(n().StrictMode,{children:(0,x.jsx)(o.BrowserRouter,{children:(0,x.jsx)(j,{})})}))},28972:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(31601),n=r.n(a),s=r(76314),o=r.n(s)()(n());o.push([e.id,"",""]);const l=o}}]);